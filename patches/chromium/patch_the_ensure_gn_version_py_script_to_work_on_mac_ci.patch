From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: Jeremy Apthorp <nornagon@nornagon.net>
Date: Fri, 12 Apr 2019 12:47:57 -0700
Subject: patch the ensure_gn_version.py script to work on mac CI

This script is temporary until https://crbug.com/944667 is resolved. We need to
patch it because on mac CI, we check out the source code on Linux, which
confuses the script.

diff --git a/buildtools/ensure_gn_version.py b/buildtools/ensure_gn_version.py
index acb1c1ddf046fd7c19ef428ca4b099ee60c7ff3c..4128853c41a75351d849cea0985f764fb504eca1 100755
--- a/buildtools/ensure_gn_version.py
+++ b/buildtools/ensure_gn_version.py
@@ -39,6 +39,11 @@ SRC_DIR = os.path.dirname(BUILDTOOLS_DIR)
 
 
 def main():
+  # NB. on Electron's CI we check out the macOS source on Linux. Bypass this
+  # check as it's not relevant on Electron CI and it gets confused.
+  if os.environ.get('CI') is not None:
+    return 0
+
   parser = argparse.ArgumentParser()
   parser.add_argument('version',
           help='CIPD "git_revision:XYZ" label for GN to sync to')
